<!DOCTYPE html>
<html>
<body>

<h2>Create Card</h2>
<input id="name" placeholder="Name"><br><br>
<input id="phone" placeholder="Phone"><br><br>
<button onclick="generate()">Generate</button>

<script>
const URL = "https://dfvnefbxgayxqgjjgtrr.supabase.co/rest/v1/cards";
const KEY = "sb_publishable_WypeFELCIlVDlqGY4PdWwA_snqoPUSE";

async function generate(){
 alert("clicked");

 const n=name.value.trim();
 const p=phone.value.trim();
 if(!n||!p){ alert("fill"); return; }

 const id=Math.random().toString(36).slice(2,8);

 const res = await fetch(URL,{
  method:"POST",
  headers:{
   "apikey":KEY,
   "Authorization":"Bearer "+KEY,
   "Content-Type":"application/json",
   "Prefer":"return=minimal"
  },
  body:JSON.stringify({
   id:id,
   data:JSON.stringify({name:n,phone:p})
  })
 });

 if(!res.ok){
  alert("HTTP ERROR: "+res.status);
 }else{
  alert("saved");
  location.href="card.html?id="+id;
 }
}
</script>

</body>
</html>
