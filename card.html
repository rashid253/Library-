<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>My Digital Card</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
/* 100% SAME DESIGN */
body{
 margin:0;
 font-family:system-ui;
 background:#f1f5f9;
 color:#0f172a;
 overflow-x:hidden;
}

.topbar{
 display:flex;
 justify-content:space-around;
 padding:10px;
 background:#0f172a;
}

.topbar a{color:white;font-size:18px}

.profile{
 display:flex;
 gap:12px;
 padding:16px;
 background:#e2e8f0;
 align-items:center;
}

.profile img{
 width:70px;
 height:70px;
 border-radius:50%;
 object-fit:contain;
 border:2px solid #cbd5f5;
 background:white;
}

.info{font-size:13px}

.downloadBtn{
 display:inline-block;
 font-size:12px;
 padding:4px 8px;
 border-radius:6px;
 background:#2563eb;
 color:white;
 margin-top:6px;
}

.about{
 padding:12px;
 background:white;
 font-size:14px;
}

.offers{
 display:flex;
 overflow-x:auto;
 scroll-snap-type:x mandatory;
}

.offer{
 min-width:90%;
 margin:12px;
 background:#2563eb;
 border-radius:16px;
 padding:12px;
 scroll-snap-align:center;
 color:white;
 display:flex;
 gap:12px;
 align-items:center;
}

.offer img{
 max-width:120px;
 max-height:100px;
 object-fit:contain;
 border-radius:8px;
}

.offerContent{flex:1}

.offer button{
 width:100%;
 padding:8px;
 border:none;
 border-radius:8px;
 background:#0f172a;
 color:white;
 margin-top:6px;
}

.dots{text-align:center}
.dots span{
 width:8px;height:8px;
 border-radius:50%;
 background:#94a3b8;
 display:inline-block;
 margin:0 3px;
}
.dots .active{background:#2563eb;width:18px;border-radius:10px}

.actions{
 display:flex;
 justify-content:space-around;
 padding:14px;
 background:#e2e8f0;
}

.actions a{font-size:22px;color:#0f172a}

.social{
 display:flex;
 justify-content:center;
 gap:18px;
 padding:10px;
}
.social a{font-size:20px;color:#2563eb}
</style>
</head>

<body>

<div class="topbar">
<a id="share"><i class="fa fa-share"></i></a>
<a id="map"><i class="fa fa-location-dot"></i></a>
<a id="sms"><i class="fa fa-comment"></i></a>
</div>

<div class="profile">
<img id="photo">
<div class="info">
<div id="name"></div>
<div id="business"></div>
<div id="phone"></div>
<div id="email"></div>
<div id="address"></div>
</div>
</div>

<div class="about" id="about"></div>

<div class="offers" id="offers"></div>
<div class="dots" id="dots"></div>

<div class="actions">
<a id="call"><i class="fa fa-phone"></i></a>
<a id="wa"><i class="fab fa-whatsapp"></i></a>
<a id="mail"><i class="fa fa-envelope"></i></a>
</div>

<div class="social">
<a id="fb"><i class="fab fa-facebook"></i></a>
<a id="ig"><i class="fab fa-instagram"></i></a>
<a id="yt"><i class="fab fa-youtube"></i></a>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
if("serviceWorker" in navigator){
 navigator.serviceWorker.register("service-worker.js");
}

const supabase = supabase.createClient(
 'https://dfvnefbxgayxqgjjgtrr.supabase.co',
 'sb_publishable_WypeFELCIlVDlqGY4PdWwA_snqoPUSE'
);

const id=new URLSearchParams(location.search).get("id");
if(!id) location="index.html";

loadCard();

async function loadCard(){
 const {data}=await supabase
  .from("cards")
  .select()
  .eq("id",id)
  .single();

 const card=JSON.parse(data.data);
 localStorage.lastCard=id;

 photo.src=card.profileImage;
 name.textContent=card.name;
 business.textContent=card.businessName;
 phone.textContent="ðŸ“ž "+card.phone;
 email.textContent="âœ‰ï¸ "+card.email;
 address.textContent="ðŸ“ "+card.address;
 about.textContent=card.businessInfo;

 call.href="tel:"+card.phone;
 wa.href="https://wa.me/"+card.phone;
 mail.href="mailto:"+card.email;
 map.href="https://maps.google.com/?q="+encodeURIComponent(card.address);
 sms.href="sms:"+card.phone;

 if(card.facebook) fb.href=card.facebook;
 if(card.instagram) ig.href=card.instagram;
 if(card.youtube) yt.href=card.youtube;

 share.onclick=()=>{
  navigator.share({
   title:card.name,
   text:card.businessName,
   url:location.href
  });
 }

 card.offers.forEach((o,i)=>{
  const d=document.createElement("div");
  d.className="offer";
  d.innerHTML=`
   ${o.image?`<img src="${o.image}">`:""}
   <div class="offerContent">
    <h3>ðŸ”¥ ${o.title}</h3>
    <p>${o.desc}</p>
    <button>Grab Offer</button>
   </div>
  `;
  d.onclick=()=>{
   const msg=`Hi, I'm interested in your offer: ${o.title}`;
   location.href="https://wa.me/"+card.phone+"?text="+encodeURIComponent(msg);
  };
  offers.appendChild(d);

  const dot=document.createElement("span");
  if(i==0) dot.classList.add("active");
  dots.appendChild(dot);
 });

 offers.addEventListener("scroll",()=>{
  const idx=Math.round(offers.scrollLeft / offers.offsetWidth);
  document.querySelectorAll(".dots span").forEach((d,i)=>{
   d.classList.toggle("active",i==idx);
  });
 });
}
</script>

</body>
</html>
