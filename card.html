<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Business Card</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">
<script>
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("sw.js");
}
</script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<style>
:root{
  --primary:#0f172a;
  --accent:#38bdf8;
  --bg:linear-gradient(135deg,#020617,#0f172a);
  --card:#111827;
  --text:#e5e7eb;
  --muted:#9ca3af;
}

body{
  margin:0;
  min-height:100vh;
  background:var(--bg);
  font-family:system-ui,Segoe UI;
  display:flex;
  justify-content:center;
  align-items:center;
}

.app-card{
  width:100%;
  max-width:380px;
  background:var(--card);
  border-radius:24px;
  padding:22px;
  color:var(--text);
  box-shadow:0 30px 60px rgba(0,0,0,.6);
  position:relative;
}

.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.header i{
  font-size:18px;
  color:var(--accent);
  cursor:pointer;
}

.profile{
  text-align:center;
  margin-top:10px;
}

.profile img{
  width:96px;
  height:96px;
  border-radius:50%;
  object-fit:cover;
  border:3px solid var(--accent);
}

.profile h2{
  margin:10px 0 4px;
  font-size:20px;
}

.profile span{
  font-size:13px;
  color:var(--muted);
}

.info{
  margin-top:18px;
  font-size:14px;
  line-height:1.6;
  color:var(--muted);
  text-align:center;
}

.quick-actions{
  display:flex;
  justify-content:space-around;
  margin-top:20px;
}

.quick-actions a{
  width:52px;
  height:52px;
  background:#1f2933;
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  color:var(--accent);
  font-size:20px;
  text-decoration:none;
}

.buttons{
  display:grid;
  gap:12px;
  margin-top:20px;
}

.buttons a{
  padding:14px;
  border-radius:14px;
  text-align:center;
  font-weight:600;
  color:white;
  text-decoration:none;
  font-size:15px;
}

.call{background:#2563eb;}
.wa{background:#22c55e;}
.mail{background:#f97316;}

.social{
  display:flex;
  justify-content:center;
  gap:18px;
  margin-top:20px;
}

.social a{
  font-size:20px;
  color:var(--muted);
}

.footer{
  text-align:center;
  font-size:11px;
  color:#6b7280;
  margin-top:18px;
}
</style>
</head>

<body>

<div class="app-card">

  <div class="header">
    <i class="fa fa-share-alt" id="shareBtn"></i>
    <i class="fa fa-download" id="saveBtn"></i>
  </div>

  <div class="profile">
    <img id="photo">
    <h2 id="name"></h2>
    <span id="business"></span>
  </div>

  <div class="info">
    <div id="businessInfo"></div>
    <div id="address"></div>
    <div id="phone"></div>
    <div id="email"></div>
  </div>

  <div class="quick-actions">
    <a id="miniCall"><i class="fa fa-phone"></i></a>
    <a id="miniWa"><i class="fab fa-whatsapp"></i></a>
    <a id="miniMail"><i class="fa fa-envelope"></i></a>
    <a id="miniMap"><i class="fa fa-location-dot"></i></a>
  </div>

  <div class="buttons">
    <a id="callBtn" class="call">Call Now</a>
    <a id="waBtn" class="wa">Chat on WhatsApp</a>
    <a id="mailBtn" class="mail">Send Email</a>
  </div>

  <div class="social">
    <a id="fb"><i class="fab fa-facebook"></i></a>
    <a id="ig"><i class="fab fa-instagram"></i></a>
    <a id="yt"><i class="fab fa-youtube"></i></a>
  </div>

  <div class="footer">
    Digital Business Card
  </div>

</div>

<script>
/* ===== DATA LOAD ===== */
let data = Object.fromEntries(new URLSearchParams(location.search));
if(Object.keys(data).length===0){
  data = JSON.parse(localStorage.getItem("cardData")||"{}");
}

/* ===== POPULATE ===== */
photo.src = data.profileImage || "";
name.textContent = data.name || "";
business.textContent = data.businessName || "";
businessInfo.textContent = data.businessInfo || "";
address.textContent = data.address || "";
phone.textContent = data.phone || "";
email.textContent = data.email || "";

/* ===== LINKS ===== */
miniCall.href = "tel:"+data.phone;
miniWa.href = "https://wa.me/"+data.phone;
miniMail.href = "mailto:"+data.email;
miniMap.href = "https://maps.google.com/?q="+encodeURIComponent(data.address);

callBtn.href = miniCall.href;
waBtn.href = miniWa.href;
mailBtn.href = miniMail.href;

if(data.facebook){ fb.href=data.facebook; fb.target="_blank"; }
if(data.instagram){ ig.href=data.instagram; ig.target="_blank"; }
if(data.youtube){ yt.href=data.youtube; yt.target="_blank"; }

/* ===== SHARE ===== */
shareBtn.onclick=()=>{
  navigator.share({
    title:data.name||"My Card",
    url:location.href
  });
};

/* ===== SAVE CONTACT ===== */
saveBtn.onclick=()=>{
  const v=`BEGIN:VCARD
VERSION:3.0
FN:${data.name}
TEL:${data.phone}
EMAIL:${data.email}
ADR:${data.address}
END:VCARD`;
  const blob=new Blob([v],{type:"text/vcard"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="contact.vcf";
  a.click();
};

/* ===== BACK BLOCK ===== */
history.pushState(null,null,location.href);
window.onpopstate=()=>{history.go(1);};
</script>

</body>
</html>
